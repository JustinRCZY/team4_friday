<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>StreamlinePro | <%=title %></title>
    <%- include('./partials/head.ejs') %>
</head>
<body>
    <nav class="navbar">
        <div class="site-title">
            <a href="/scrumboard"><h1>Burndown Chart - <%= sprint.sprintname %></h1></a>
        </div>
      <ul>
        <li>
          <a href="#">Navigation Directory</a>
          <ul>
            <li><a href="/scrumboard">Scrum Board</a></li>
            <li><a href="/blogs">Product Backlog</a></li>
          </ul>
        </li>
      </ul>
      </nav>

      <head>
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      </head>
      <body>
      
      <div style="width:80%;">
        <canvas id="effortChart"></canvas>
      </div>
      
      <div>
        <label><input type="checkbox" id="line1Checkbox" checked> All members</label>
        <label><input type="checkbox" id="line2Checkbox" checked> Myint Myat Thura</label>
        <label><input type="checkbox" id="line3Checkbox" checked> Safrina</label>
        <label><input type="checkbox" id="line4Checkbox" checked> Samantha</label>
        <label><input type="checkbox" id="line5Checkbox" checked> Justin</label>
        <label><input type="checkbox" id="line6Checkbox" checked> Fawwaz</label>
      </div>
      
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          // Sample data (replace with your actual data)
          var days = Array.from({ length: <%= JSON.stringify(sprint.burndown) %>.length }, (_, index) => index + 1);;
          var line1Data = <%= JSON.stringify(sprint.burndown) %>;
          var line2Data = [0, 3, 6, 9, 12, 15];
          var line3Data = [5, 2, 7, 9, 11, 13];
          var line4Data = [1, 4, 6, 8, 10, 12];
          var line5Data = [0, 2, 4, 8, 10, 14];
          var line6Data = [3, 6, 9, 12, 15, 18];
      
          var ctx = document.getElementById('effortChart').getContext('2d');
      
          var chart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: days,
              datasets: [
                {
                  label: 'All members',
                  data: line1Data,
                  borderColor: 'rgba(255, 99, 132, 1)',
                  hidden: false
                },
                {
                  label: 'Myint Myat Thura',
                  data: line2Data,
                  borderColor: 'rgba(54, 162, 235, 1)',
                  hidden: false
                },
                {
                  label: 'Safrina',
                  data: line3Data,
                  borderColor: 'rgba(255, 206, 86, 1)',
                  hidden: false
                },
                {
                  label: 'Samantha',
                  data: line4Data,
                  borderColor: 'rgba(75, 192, 192, 1)',
                  hidden: false
                },
                {
                  label: 'Justin',
                  data: line5Data,
                  borderColor: 'rgba(153, 102, 255, 1)',
                  hidden: false
                },
                {
                  label: 'Fawwaz',
                  data: line6Data,
                  borderColor: 'rgba(255, 159, 64, 1)',
                  hidden: false
                }
              ]
            },
            options: {
              scales: {
                x: {
                  type: 'linear',
                  position: 'bottom'
                },
                y: {
                  type: 'linear',
                  position: 'left',
                  suggestedMax: Math.max(...line1Data, ...line2Data, ...line3Data, ...line4Data, ...line5Data, ...line6Data) + 5
                }
              }
            }
          });
      
          // Checkbox event listeners
          document.getElementById('line1Checkbox').addEventListener('change', function () {
            chart.data.datasets[0].hidden = !this.checked;
            chart.update();
          });
      
          document.getElementById('line2Checkbox').addEventListener('change', function () {
            chart.data.datasets[1].hidden = !this.checked;
            chart.update();
          });
      
          document.getElementById('line3Checkbox').addEventListener('change', function () {
            chart.data.datasets[2].hidden = !this.checked;
            chart.update();
          });
      
          document.getElementById('line4Checkbox').addEventListener('change', function () {
            chart.data.datasets[3].hidden = !this.checked;
            chart.update();
          });
      
          document.getElementById('line5Checkbox').addEventListener('change', function () {
            chart.data.datasets[4].hidden = !this.checked;
            chart.update();
          });
      
          document.getElementById('line6Checkbox').addEventListener('change', function () {
            chart.data.datasets[5].hidden = !this.checked;
            chart.update();
          });
        });
      </script>
      
      </body>
      </html>





<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>StreamlinePro | <%=title %></title>
    <%- include('./partials/head.ejs') %>
</head>
<body>
    <nav class="navbar">
        <div class="site-title">
            <a href="/scrumboard"><h1>Burndown Chart - <%= sprint.sprintname %></h1></a>
        </div>
      <ul>
        <li>
          <a href="#">Navigation Directory</a>
          <ul>
            <li><a href="/scrumboard">Scrum Board</a></li>
            <li><a href="/blogs">Product Backlog</a></li>
          </ul>
        </li>
      </ul>
      </nav>

      
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script>
    /**
     * Sum elements of an array up to the index provided.
     */
    function sumArrayUpTo(arrData, index) {
      var total = 0;
      for (var i = 0; i <= index; i++) {
        if (arrData.length > i) {
          total += arrData[i];
            }
      }
      return total;
    }

    function calcideal(index,totalHoursInSprint,idealHoursPerDay,scopeChange) {
        var data = [];
            for (var i = 0; i < index; i++) {
            var currentValue = totalHoursInSprint - (idealHoursPerDay * i) + sumArrayUpTo(scopeChange, i - 1);
            data.push(Math.round(currentValue));
        }
        return data
    }
    
    function showBurnDown(elementId, burndownData, scopeChange = []) {
    
      var speedCanvas = document.getElementById(elementId);
      var total = 0;

      const newArray = <%= JSON.stringify(sprint.burndown) %>.map((value, index) => `day ${index + 1}`);
      <% tasks.forEach(task => { %>
      total += <%= task.storypoint %>;
        <% }) %>
    
      Chart.defaults.global.defaultFontFamily = "Arial";
      Chart.defaults.global.defaultFontSize = 14;
      const totalHoursInSprint = total;
      const idealHoursPerDay = totalHoursInSprint / (newArray.length-1);
      const test = calcideal(newArray.length,totalHoursInSprint,idealHoursPerDay,scopeChange);
      const empty = [0]

      i = 0;
    
      var speedData = {
        labels: newArray,
        datasets: [
          {
            label: "Actual",
            data: burndownData,
            fill: false,
            borderColor: "#EE6868",
            backgroundColor: "#EE6868",
            lineTension: 0,
          },
          {
            label: "Ideal",
            borderColor: "#6C8893",
            backgroundColor: "#6C8893",
            lineTension: 0,
            borderDash: [5, 5],
            fill: false,
            data: empty
          },
        ]
      };
    
      var chartOptions = {
        legend: {
          display: true,
          position: 'top',
          labels: {
            boxWidth: 80,
            fontColor: 'black'
          }
        },
        scales: {
            yAxes: [{
                ticks: {
                    min: 0,
                    max: Math.round(burndownData[0] * 1.1)
                }
            }]
        }
      };
    
      var lineChart = new Chart(speedCanvas, {
        type: 'line',
        data: speedData,
        options: chartOptions
      });
    
    }
    </script>
    </head>
    
    <body>
    
    <div style="width:800px;"><canvas id="burndown43"></canvas></div>
    <script>
    showBurnDown (
      "burndown43",
      //   1    2    3    4    5    6    7    8    9   10
      <%= JSON.stringify(sprint.burndown) %>, // burndown data
      [0]*<%= JSON.stringify(sprint.burndown) %>.length  // scope change
    );
    </script>
</body>
</html> -->